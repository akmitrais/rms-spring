<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>RMS Spring</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <h1>Resource Management System with Spring</h1>
	<a href="/">Dashboard</a>
    <p>
        This is the library management page.
    </p>

    <table>
        <thead>
            <tr>
                <th>No.</th>
                <th>Name</th>
                <th>Max Capacity</th>
                <th>Current Capacity</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr th:if="${#lists.isEmpty(shelves)}">
                <td colspan="5">No data.</td>
            </tr>
            <tr th:each="shelf : ${shelves}">
                <td th:text="${shelfStat.count}">1</td>
                <td th:text="${shelf.name}">1234</td>
                <td th:text="${shelf.maxCapacity}"></td>
                <td th:text="${shelf.currentCapacity}"></td>
                <td>
                    <a th:href="@{'/libraries/'+${shelf.id}}+'/update'">Update</a>
                    <button class="link-button" th:data-url="@{'/libraries/'+${shelf.id}}+'/delete'" th:data-id="${shelf.id}" onclick="deleteBook(this);">Delete</button>
                </td>
            </tr>
        </tbody>
    </table>
    <br />
    <a th:href="@{'/libraries'}">Refresh</a>
	<hr />
	<h3>Library Form</h3>
    <form method="post" th:object="${shelf}">
        <input type="text" th:field="*{name}" th:value="*{name}" placeholder="Name" />
        <input type="text" th:field="*{maxCapacity}" th:value="*{maxCapacity}" placeholder="Max Capacity"/>
        <input type="submit" value="Submit" />
    </form>

    <form id="deleteForm" method="post" action="" style="display: none;">
        <input id="deleteId" type="text" name="id" value="" />
    </form>

    <script>
        deleteBook = function (el) {
            let deleteId = document.getElementById("deleteId");
            let deleteForm = document.getElementById("deleteForm");

            deleteId.value = el.getAttribute('data-value');
            deleteForm.action = el.getAttribute('data-url');

            if (confirm("Are you sure?")) {
                deleteForm.submit();
            }
        }
    </script>
</body>
</html>